{% extends 'admin_dash.html'%}
{%block content%}
<style>
    #achu{
        width:50px;
        border-radius:5px;
    }
</style>
<style>
    body {
        background-color: #232323;
    }
    
    .container {
        background-color: #111;
        padding: 20px;
        border-radius: 5px;
        color: #fff;
    }
    
    .table-title {
        margin-bottom: 15px;
    }
    
    .table-title h2 {
        margin: 0;
        padding: 0;
        font-size: 28px;
        color: #fff;
    }
    
    .btn-add {
        background-color: #5cb85c;
        border-color: #4cae4c;
    }
    
    .btn-add:hover {
        background-color: #4cae4c;
        border-color: #4cae4c;
    }
    
    .btn-edit {
        background-color: #17a2b8;
        border-color: #138496;
    }
    
    .btn-edit:hover {
        background-color: #138496;
        border-color: #138496;
    }
    
    .btn-list {
        background-color: #dc3545;
        border-color: #c82333;
    }
    
    .btn-list:hover {
        background-color: #c82333;
        border-color: #c82333;
    }
    
    .btn-unlist {
        background-color: #28a745;
        border-color: #1e7e34;
    }
    
    .btn-unlist:hover {
        background-color: #1e7e34;
        border-color: #1e7e34;
    }
    
    .pagination {
        justify-content: center;
    }
    
    
    thead th {
        color: #fff;
    }
    tbody td{
        color: #fff;
    }
</style>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<body>
    {% if messages %}
    <ul class="messages">
      {% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
      {% endfor %}
    </ul>
  {% endif %}
    <div class="container">
        <div class="table-title">
            <div class="row">
                <div class="col-sm-6">
                    <h2>Manage <b>Products</b></h2>
                </div>
                <div class="col-sm-6">
                    <a href="{% url 'add'  %}" class="btn btn-add"><i class="fas fa-plus"></i> Add New Product</a>
                </div>
            </div>
        </div>
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Product Name</th>
                    <th>Image</th>
                    <th>Category</th>
                    <th>Description</th>
                    <th>Variants</th>
                    <th>Listed</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Product Name</th>
                        <th>Image</th>
                        <th>Category</th>
                        <th>Description</th>
                        <th>Variants</th>
                        <th>Listed</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for i in orgi %}
                    <tr>
                        <td>{{ i.name }}</td>
                        <td>
                            <div id="achu">
                                {% if i.images.all %}
                                {% with i.images.all|first as img %}
                                <img class="img-fluid w-100" src="{{ img.image.url }}" alt="{{ product.name }}">
                                {% endwith %}
                                {% endif %}
                            </div>
                        </td>
                        <td>{{ i.category }}</td>
                        <td>{{ i.description }}</td>
                        <td>
                            <a href="{% url 'add_variants' i.id %}" class="btn btn-add">
                                <i class="fas fa-plus"></i> Add
                            </a>
                            <a href="{% url 'edit_variants' i.id %}" class="btn btn-edit">
                                <i class="fas fa-edit"></i> Edit
                            </a>
                        </td>
                        <td>
                            <form class="list-unlist-form" data-product-id="{{ i.id }}">
                                {% csrf_token %}
                                <input type="hidden" name="product_id" value="{{ i.id }}">
                                {% if i.listed %}
                                <button type="button" name="action" value="unlist" class="btn btn-unlist list-unlist-btn">
                                    <i class="fas fa-eye-slash"></i> Unlist
                                </button>
                                {% else %}
                                <button type="button" name="action" value="list" class="btn btn-list list-unlist-btn">
                                    <i class="fas fa-eye"></i> List
                                </button>
                                {% endif %}
                            </form>
                        </td>
                        <td>
                            <a href="{% url 'update' i.id %}" class="btn btn-edit"><i class="fas fa-edit"></i> Edit</a>
                            <a href="{% url 'delete' i.id %}" class="btn btn-edit product-delete-btn" data-product-id="{{ i.id }}"><i class="fas fa-trash"></i> Delete</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        <div class="clearfix">
            <div class="hint-text">Showing <b>5</b> out of <b>25</b> entries</div>
            <ul class="pagination">
                <li class="page-item active"><a href="#" class="page-link">1</a></li>
                <li class="page-item"><a href="#" class="page-link">2</a></li>
                <li class="page-item"><a href="#" class="page-link">3</a></li>
                <li class="page-item"><a href="#" class="page-link">4</a></li>
                <li class="page-item"><a href="#" class="page-link">5</a></li>
            </ul>
        </div>
    </div>
</body>
<script defer src="https://cdn.crop.guide/loader/l.js?c=SDMRSY"></script>
<script>
$(function() {
    var rowsPerPage = 5; // change this to the number of rows you want to display per page
    var currentPage = 1;
    var totalRows = $('table tbody tr').length;
    var totalPages = Math.ceil(totalRows / rowsPerPage);
    
    // hide all rows and show the first n rows (based on rowsPerPage)
    $('table tbody tr').hide();
    $('table tbody tr').slice(0, rowsPerPage).show();
    
    // generate the pagination links
    for (var i = 1; i <= totalPages; i++) {
        var activeClass = i === 1 ? 'active' : '';
        $('.pagination').append('<li class="page-item ' + activeClass + '"><a href="#" class="page-link">' + i + '</a></li>');
    }
    
    // handle click events on pagination links
    $('.pagination').on('click', 'a', function(event) {
        event.preventDefault();
        var page = parseInt($(this).text());
        if (page !== currentPage) {
            currentPage = page;
            var start = (currentPage - 1) * rowsPerPage;
            var end = start + rowsPerPage;
            $('table tbody tr').hide();
            $('table tbody tr').slice(start, end).show();
            $('.pagination li').removeClass('active');
            $('.pagination li:nth-child(' + currentPage + ')').addClass('active');
        }
    });
});
</script>
{% endblock %}